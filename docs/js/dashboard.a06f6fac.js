(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["dashboard"],{"3bac":function(t,e,a){},7656:function(t,e,a){},9406:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-spin",{attrs:{spinning:t.loading,tip:"loading"}},[a("div",{staticClass:"dashboard-container",style:{top:t.offset.top+"px",left:t.offset.left+"px"}},[a("div",{staticClass:"dashboard",style:Object.assign({},t.dashboard.container.style,{width:t.dashboard.container.layout.width+"px",height:t.dashboard.container.layout.height+"px",backgroundImage:t.dashboard.container.style.backgroundImage?"url("+t.dashboard.container.style.backgroundImage+")":t.generateBackgroundGradient(t.dashboard.container.style.backgroundGradient),transform:"scale("+t.scale+")"})},[a("LoopPanels",{attrs:{"api-collection":t.dashboard.apiCollection,list:t.dashboard.list,container:t.dashboard.container}})],1)])])},i=[],o=a("2909"),r=a("5530"),s=a("1da1"),c=(a("d3b7"),a("3ca3"),a("ddb0"),a("d81d"),a("a434"),a("a9e3"),a("159b"),a("4de4"),a("96cf"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",t._l(t.list,(function(e,n){return a("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"item.visible"}],key:e.id,staticClass:"panel-wrapper",style:{zIndex:n,width:e.layout.width?e.layout.width+"px":"auto",height:e.layout.height?e.layout.height+"px":"auto",marginTop:(t.parent?-t.parent.layout.y:0)+"px",marginLeft:(t.parent?-t.parent.layout.x:0)+"px",transform:"translate("+e.layout.x+"px, "+e.layout.y+"px)"},attrs:{id:e.id}},[a("div",{staticClass:"animate",attrs:{id:"animate-"+e.id}},[e.isRoot?a("LoopPanels",{attrs:{parent:e,"api-collection":t.apiCollection,list:e.children,container:t.container}}):a("Panel",{attrs:{"data-source":e,"api-collection":t.apiCollection,container:t.container,play:!0}})],1)])})),0)}),d=[],l=a("9c97"),u={name:"LoopPanels",components:{Panel:l["a"]},props:{parent:{type:Object},apiCollection:{type:Array,required:!0,default:function(){return[]}},list:{type:Array,required:!0},container:{type:Object,required:!0}}},h=u,f=(a("ffde"),a("2877")),b=Object(f["a"])(h,c,d,!1,null,"32c6510e",null),p=b.exports,m=a("c84c"),y=a("ac8d"),g=a("9d4d"),v=a("8f47a"),w=a("83c8"),O={components:{LoopPanels:p},data:function(){return{bodyRect:0,constants:{templates:w["default"]},loading:!1,offset:{top:0,left:0},dashboard:{container:{layout:{},style:{}},list:[],animationList:[]}}},computed:{scale:function(){var t=this.dashboard.container.layout,e=t.width,a=t.height,n=this.bodyRect.width/e,i=this.bodyRect.height/a,o=Math.min(n,i);return this.setOffset(o||1,e,a),o||1}},mounted:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var a,n,i,o,r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t,n=t.$route.query,i=n.id,o=n.token,r=n.template,s=n.preview,t.setBodyRect(),!i){e.next=8;break}return e.next=6,t.initDashboardById(i);case 6:e.next=14;break;case 8:if(!o){e.next=13;break}return e.next=11,t.initDashboardByToken(o);case 11:e.next=14;break;case 13:r?t.initDashboardByTemplate(r):s&&t.initDashboardByStorage();case 14:t.$nextTick((function(){t.animate("mounted")})),Object(g["a"])(window,"resize",Object(g["c"])(t.setBodyRect,300)),Object(g["a"])(window,"beforeRouteLeave",(function(t){var e=t.detail.callback;a.animate("beforeRouteLeave",e)}));case 17:case"end":return e.stop()}}),e)})))()},beforeDestroy:function(){clearTimeout(this.animateTimer),Object(g["o"])(window,"resize",Object(g["c"])(this.setBodyRect,300))},methods:{generateBackgroundGradient:g["i"],setBodyRect:function(){this.bodyRect=document.documentElement.getClientRects()[0]},initDashboardById:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.loading=!0,a.next=3,Object(m["a"])(t).then((function(t){if(0===t.code){var a,n=null!==(a=t.data)&&void 0!==a&&a.config?JSON.parse(t.data.config):{};e.requestCollection(n.apiCollection,(function(){e.loading=!1,e.dashboard=Object(r["a"])(Object(r["a"])({},n),{},{title:t.data.title})}))}else e.loading=!1,e.$message.error(t.desc)}),(function(){e.loading=!1}));case 3:case"end":return a.stop()}}),a)})))()},initDashboardByToken:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.loading=!0,a.next=3,Object(y["a"])(t).then((function(t){if(e.loading=!1,0===t.code){var a=t.data,n=a.title,i=a.config;e.dashboard=Object(r["a"])(Object(r["a"])({},JSON.parse(i)),{},{title:n})}else e.$message.error(t.desc)}),(function(){e.loading=!1}));case 3:case"end":return a.stop()}}),a)})))()},initDashboardByTemplate:function(t){var e=this.constants.templates[t],a=e.title,n=e.config;this.dashboard=Object(r["a"])(Object(r["a"])({},n),{},{title:a})},initDashboardByStorage:function(){var t=sessionStorage.getItem("dashboard");this.dashboard=JSON.parse(t)},requestCollection:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1?arguments[1]:void 0;Promise.all(e.map((function(a,n){Object(v["a"])(a,(function(t){var i=Object(r["a"])(Object(r["a"])({},a),{},{data:Object(g["d"])(t)});e.splice(n,1,i)}),(function(e){t.$message.error("Network Error")})),a.interval&&t.intervalGetAsyncData(a.interval,a.api,(function(){return Object(v["a"])(a,(function(t){var i=Object(r["a"])(Object(r["a"])({},a),{},{data:Object(g["d"])(t)});e.splice(n,1,i)}),(function(e){t.$message.error("Network Error")}))}))}))).then((function(t){a&&a()}))},intervalGetAsyncData:function(t,e,a){clearInterval(this[e]),Number(t)&&(this[e]=setInterval(a,1e3*t))},setOffset:function(t,e,a){this.offset.top=(this.bodyRect.height-a*t)/2,this.offset.left=(this.bodyRect.width-e*t)/2},animate:function(t,e){var a=this;this.dashboard.animationList.filter((function(e){return e.animation.timeNode===t})).forEach((function(t){var e=t.id,n=t.animation,i=n.type,o=n.value,r=n.delay,s=n.speed,c=a.$el.querySelector("#animate-".concat(e));c&&(c.style.opacity="in"===i?0:1,a.animateTimer=setTimeout((function(){c.className="animate animate__animated animate__".concat(o),c.style.animationDuration="".concat(s,"s"),c.style.opacity=1}),1e3*r))}));var n=this.dashboard.animationList.filter((function(e){return e.animation.timeNode===t})).map((function(t){return t.animation.delay+t.animation.speed})),i=Math.max.apply(Math,Object(o["a"])(n));e&&setTimeout((function(){e()}),i/2*1e3)}}},j=O,x=(a("f9e1"),Object(f["a"])(j,n,i,!1,null,"15ef9090",null));e["default"]=x.exports},f9e1:function(t,e,a){"use strict";a("3bac")},ffde:function(t,e,a){"use strict";a("7656")}}]);
//# sourceMappingURL=dashboard.a06f6fac.js.map